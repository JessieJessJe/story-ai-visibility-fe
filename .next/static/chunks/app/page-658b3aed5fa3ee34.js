(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3890:function(e,s,t){Promise.resolve().then(t.bind(t,6551))},6551:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return $}});var a,l,r,n=t(7437),i=t(2265),d=t(9322),o=t(3245);function c(){return(0,n.jsx)("header",{className:"border-b border-slate-200 bg-white",children:(0,n.jsxs)("div",{className:"mx-auto flex w-full max-w-6xl items-center justify-between gap-4 px-6 py-5",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:"Brand Visibility"}),(0,n.jsx)("p",{className:"mt-1 text-sm text-slate-600",children:"Understand how AI providers appear in your narratives."})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 rounded-lg bg-slate-100 px-3 py-2 text-sm text-slate-700",children:[(0,n.jsx)(o.Z,{className:"h-4 w-4","aria-hidden":!0}),"Mask providers before running analysis to reduce bias."]})]})})}function m(){return(0,n.jsx)("footer",{className:"border-t border-slate-200 bg-white",children:(0,n.jsxs)("div",{className:"mx-auto flex w-full max-w-6xl items-center justify-between px-6 py-4 text-xs text-slate-500",children:[(0,n.jsxs)("span",{children:["\xa9 ",new Date().getFullYear()," Brand Visibility"]}),(0,n.jsx)("span",{children:"Health check at /health"})]})})}var u=t(9397),x=t(2489),p=t(535),h=t(1994);function f(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,h.W)(s)}let v=(0,p.j)("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 focus-visible:outline-primary",secondary:"bg-slate-200 text-slate-900 hover:bg-slate-300 focus-visible:outline-slate-400",ghost:"bg-transparent text-slate-700 hover:bg-slate-100 focus-visible:outline-slate-200",danger:"bg-danger text-danger-foreground hover:bg-danger/90 focus-visible:outline-danger"},size:{default:"h-10 px-4 py-2",sm:"h-9 px-3",lg:"h-11 px-6 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),g=i.forwardRef((e,s)=>{let{className:t,variant:a,size:l,...r}=e;return(0,n.jsx)("button",{ref:s,className:f(v({variant:a,size:l,className:t})),...r})});g.displayName="Button";let b={default:"bg-slate-200 text-slate-900",success:"bg-green-100 text-green-800",warning:"bg-amber-100 text-amber-800",danger:"bg-danger/10 text-danger",outline:"border border-slate-200 text-slate-700"},j=e=>{let{className:s,variant:t="default",...a}=e;return(0,n.jsx)("span",{className:f("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",b[t],s),...a})};function y(e){let{text:s,providerName:t,providerAliases:a,isLoading:l,onTextChange:r,onProviderNameChange:d,onProviderAliasesChange:o,onAnalyze:c,onLoadSample:m,showLoadSampleButton:p=!1}=e,[h,f]=(0,i.useState)(""),[v,b]=(0,i.useState)(!1),y=s.trim().length>0&&!l,N=()=>{let e=h.trim();if(e){if(a.includes(e)){f("");return}o([...a,e]),f("")}},w=e=>{o(a.filter(s=>s!==e))};return(0,n.jsxs)("section",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Transcript"}),p&&m?(0,n.jsx)(g,{type:"button",variant:"secondary",size:"sm",onClick:m,disabled:l,children:"Load sample"}):null]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("textarea",{value:s,onChange:e=>r(e.target.value),disabled:l,placeholder:"Paste your story transcript here...",className:"min-h-[220px] w-full resize-y rounded-lg border border-slate-200 bg-white p-4 text-sm shadow-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/40 disabled:cursor-not-allowed"}),(0,n.jsxs)("div",{className:"mt-1 text-right text-xs text-slate-500",children:[s.length.toLocaleString()," characters"]})]}),(0,n.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white p-4 shadow-sm",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("h3",{className:"text-base font-semibold text-slate-900",children:"Provider masking"}),(0,n.jsx)(g,{type:"button",variant:"ghost",size:"sm",onClick:()=>b(e=>!e),children:v?"Hide advanced":"Advanced masking"})]}),(0,n.jsxs)("div",{className:"mt-4 grid gap-4 md:grid-cols-2",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-slate-700",children:"Provider name"}),(0,n.jsx)("input",{value:t,onChange:e=>d(e.target.value),disabled:l,placeholder:"OpenAI",className:"h-10 w-full rounded-md border border-slate-200 bg-white px-3 text-sm shadow-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30 disabled:cursor-not-allowed"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-slate-700",children:"Provider aliases"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("input",{value:h,onChange:e=>f(e.target.value),onKeyDown:e=>{("Enter"===e.key||","===e.key)&&(e.preventDefault(),N())},disabled:l,placeholder:"Add alias and press Enter",className:"h-10 flex-1 rounded-md border border-slate-200 bg-white px-3 text-sm shadow-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30 disabled:cursor-not-allowed"}),(0,n.jsxs)(g,{type:"button",variant:"secondary",size:"sm",onClick:N,disabled:l,children:[(0,n.jsx)(u.Z,{className:"h-4 w-4","aria-hidden":!0}),(0,n.jsx)("span",{className:"sr-only",children:"Add alias"})]})]}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:a.map(e=>(0,n.jsxs)(j,{variant:"outline",className:"flex items-center gap-1",children:[e,(0,n.jsx)("button",{type:"button",onClick:()=>w(e),className:"rounded-full p-0.5 text-slate-500 hover:bg-slate-200","aria-label":"Remove alias ".concat(e),disabled:l,children:(0,n.jsx)(x.Z,{className:"h-3 w-3","aria-hidden":!0})})]},e))})]})]}),v?(0,n.jsxs)("div",{className:"mt-4 space-y-2 text-sm text-slate-600",children:[(0,n.jsx)("p",{children:"Advanced masking replaces occurrences of provider aliases before sending transcripts to the backend. This helps reduce bias when evaluating language models."}),(0,n.jsx)("p",{children:"Customize aliases to reflect the ways your team references the provider in writing."})]}):null]}),(0,n.jsx)("div",{className:"flex flex-wrap items-center justify-end gap-3",children:(0,n.jsx)(g,{type:"button",size:"lg",onClick:c,disabled:!y,children:l?"Analyzing…":"Analyze"})})]})}let N={mask:"Mask aliases",pillars:"Analyze pillars",questions:"Score questions",models:"Compare models",evaluate:"Evaluate impact"};function w(e){let{percentage:s,currentStep:t,steps:a,isActive:l}=e;return(0,n.jsxs)("section",{className:"rounded-lg border border-slate-200 bg-white p-4 shadow-sm",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("h2",{className:"text-base font-semibold text-slate-900",children:"Analysis progress"}),(0,n.jsx)(j,{variant:l?"default":"success",children:l?"Running":"Complete"})]}),(0,n.jsx)("div",{className:"mt-4 h-2 w-full overflow-hidden rounded-full bg-slate-100",children:(0,n.jsx)("div",{className:"h-full rounded-full bg-primary transition-all",style:{width:"".concat(s,"%")}})}),(0,n.jsx)("ol",{className:"mt-4 grid gap-2 text-sm text-slate-600 md:grid-cols-5",children:a.map(e=>{let l=s>=(a.indexOf(e)+1)/a.length*100,r=t===e;return(0,n.jsx)("li",{className:l?"rounded-md border border-primary/30 bg-primary/10 px-3 py-2 font-medium text-primary":r?"rounded-md border border-accent/40 bg-accent/10 px-3 py-2 font-medium text-emerald-700":"rounded-md border border-slate-200 bg-slate-50 px-3 py-2",children:N[e]},e)})})]})}var _=t(2735);function I(e){let{result:s,onExport:t}=e;return(0,n.jsxs)("section",{className:"rounded-lg border border-slate-200 bg-white p-4 shadow-sm",children:[(0,n.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Results"}),(0,n.jsxs)("p",{className:"mt-1 text-sm text-slate-600",children:["Story ID "," ",(0,n.jsx)("span",{className:"font-mono text-slate-800",children:s.storyId})]})]}),(0,n.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,n.jsxs)(j,{variant:"outline",children:["Provider: ",s.metadata.providerName]}),(0,n.jsxs)(j,{variant:"live"===s.metadata.mode?"success":"warning",children:["Mode: ",s.metadata.mode]}),s.metadata.clientName?(0,n.jsxs)(j,{variant:"default",children:["Client: ",s.metadata.clientName]}):null]})]}),(0,n.jsxs)("div",{className:"mt-4 grid gap-4 md:grid-cols-2",children:[(0,n.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-4",children:[(0,n.jsx)("p",{className:"text-sm text-slate-600",children:"Total questions evaluated"}),(0,n.jsx)("p",{className:"mt-2 text-3xl font-semibold text-slate-900",children:s.summary.totalQuestions.toLocaleString()})]}),(0,n.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-4",children:[(0,n.jsx)("p",{className:"text-sm text-slate-600",children:"Provider recognized in"}),(0,n.jsxs)("p",{className:"mt-2 text-3xl font-semibold text-slate-900",children:[s.summary.aiProviderRecognizedIn.toLocaleString()," responses"]})]})]}),(0,n.jsx)("div",{className:"mt-4 flex flex-wrap items-center gap-3",children:(0,n.jsxs)(g,{type:"button",variant:"secondary",onClick:t,children:[(0,n.jsx)(_.Z,{className:"h-4 w-4","aria-hidden":!0}),"Export JSON"]})})]})}function k(e){let{models:s,pillars:t}=e;if(!s.length||!t.length)return null;let a=s.map(e=>{let s=0,a=0;for(let l of t)for(let t of l.questions)for(let l of t.responses)l.model===e&&(s+=1,l.inferred&&(a+=1));let l=s>0?a/s*100:0;return{model:e,total:s,inferred:a,rate:l}}),l=t.map(e=>{let t={};for(let a of s){let s=0,l=0;for(let t of e.questions)for(let e of t.responses)e.model===a&&(s+=1,e.inferred&&(l+=1));let r=s>0?l/s*100:0;t[a]={pillarTitle:e.title,model:a,inferred:l,total:s,rate:r}}return{pillarTitle:e.title,modelRates:t}});return(0,n.jsxs)("section",{className:"space-y-6 rounded-lg border border-slate-200 bg-white p-6 shadow-sm",children:[(0,n.jsxs)("header",{className:"space-y-1",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:"Model comparison"}),(0,n.jsx)("p",{className:"text-sm text-slate-600",children:"Inference rates show how often each model identified the masked provider."})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-slate-700",children:"Overall inference rate"}),(0,n.jsx)("div",{className:"mt-3 space-y-3",children:a.map(e=>{var s;return(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("span",{className:"w-24 text-sm font-semibold text-slate-800",children:e.model}),(0,n.jsx)("div",{className:"h-3 flex-1 rounded-full bg-slate-100",children:(0,n.jsx)("div",{className:"h-full rounded-full ".concat((s=e.rate)>=80?"bg-emerald-500":s>=50?"bg-amber-500":"bg-rose-500"),style:{width:"".concat(e.rate,"%")}})}),(0,n.jsxs)("span",{className:"w-16 text-right text-sm font-semibold text-slate-700",children:[Math.round(e.rate),"%"]})]},e.model)})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-slate-700",children:"Inference by pillar"}),(0,n.jsx)("div",{className:"mt-3 overflow-x-auto",children:(0,n.jsxs)("table",{className:"min-w-full border-collapse",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"py-2 px-4 text-left text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Pillar"}),s.map(e=>(0,n.jsx)("th",{className:"py-2 px-4 text-center text-xs font-semibold uppercase tracking-wide text-slate-500",children:e},e))]})}),(0,n.jsx)("tbody",{children:l.map(e=>(0,n.jsxs)("tr",{className:"border-t border-slate-200",children:[(0,n.jsx)("td",{className:"py-2 px-4 text-sm font-medium text-slate-800",children:e.pillarTitle}),s.map(s=>{var t,a;let l=null!==(a=null===(t=e.modelRates[s])||void 0===t?void 0:t.rate)&&void 0!==a?a:0;return(0,n.jsx)("td",{className:"py-2 px-4",children:(0,n.jsxs)("div",{className:"mx-auto flex h-9 w-9 items-center justify-center rounded-full text-xs font-semibold text-white",style:{backgroundColor:l>=80?"#10b981":l>=50?"#f59e0b":"#f43f5e"},children:[Math.round(l),"%"]})},"".concat(e.pillarTitle,"-").concat(s))})]},e.pillarTitle))})]})})]})]})}var P=t(401),C=t(2135),R=t(875),A=t(4857),S=t(5136);function T(e){let{pillars:s}=e;return s.length?(0,n.jsxs)("section",{className:"space-y-4",children:[(0,n.jsx)("h3",{className:"text-base font-semibold text-slate-900",children:"Pillars"}),(0,n.jsx)("div",{className:"grid gap-4 lg:grid-cols-2",children:s.map(e=>(0,n.jsxs)("article",{className:"space-y-4 rounded-lg border border-slate-200 bg-white p-4 shadow-sm",children:[(0,n.jsxs)("header",{className:"flex items-start justify-between gap-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-lg font-semibold text-slate-900",children:e.title}),(0,n.jsx)("p",{className:"mt-1 text-sm text-slate-600",children:e.summary})]}),(0,n.jsx)(j,{variant:e.aiProviderInferred?"success":"outline",children:e.aiProviderInferred?"✔ inferred":"✖ not inferred"})]}),(0,n.jsx)("div",{className:"space-y-4",children:e.questions.map(s=>(0,n.jsx)(Z,{question:s,pillarTitle:e.title},s.prompt))})]},e.title))})]}):null}function Z(e){var s;let{question:t,pillarTitle:a}=e;return(0,n.jsx)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-4",children:(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("header",{className:"space-y-1",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-slate-800",children:t.prompt}),(0,n.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-600",children:[(0,n.jsxs)(j,{variant:"outline",children:["Category: ",t.category]}),(0,n.jsxs)(j,{variant:"outline",children:["Kind: ",t.kind]}),(0,n.jsx)(j,{variant:t.aiProviderInferred?"success":"outline",children:t.aiProviderInferred?"✔ provider inferred":"✖ provider hidden"})]}),(null===(s=t.assumptions)||void 0===s?void 0:s.length)?(0,n.jsx)("ul",{className:"mt-2 list-disc space-y-1 pl-5 text-xs text-slate-600",children:t.assumptions.map((e,s)=>{var l;return(0,n.jsx)("li",{children:e},"".concat(a,"-").concat(null!==(l=t.id)&&void 0!==l?l:t.prompt,"-assumption-").concat(s))})}):null]}),(0,n.jsx)("div",{className:"space-y-3",children:t.responses.map(e=>{var s;return(0,n.jsx)(E,{model:e.model,answer:e.answer,inferred:null!==(s=e.inferred)&&void 0!==s&&s},"".concat(t.prompt,"-").concat(e.model))})})]})})}function E(e){let{model:s,answer:t,inferred:a}=e,[l,r]=(0,i.useState)(!1),[d,o]=(0,i.useState)(!0),c=async()=>{try{await navigator.clipboard.writeText(t),r(!0),setTimeout(()=>r(!1),1500)}catch(e){console.error("Failed to copy",e)}};return(0,n.jsxs)("div",{className:"rounded-md border border-slate-200 bg-white",children:[(0,n.jsxs)("button",{type:"button",onClick:()=>o(e=>!e),className:"flex w-full items-center justify-between gap-2 px-3 py-2 text-left text-sm font-medium text-slate-700 hover:bg-slate-100",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"font-semibold text-slate-900",children:s}),(0,n.jsxs)(j,{variant:a?"success":"outline",children:[a?(0,n.jsx)(P.Z,{className:"mr-1 h-3 w-3","aria-hidden":!0}):null,a?"Inferred":"Not inferred"]})]}),(0,n.jsxs)("span",{className:"flex items-center gap-2 text-xs text-slate-500",children:[d?"Hide answer":"Show answer",d?(0,n.jsx)(C.Z,{className:"h-4 w-4","aria-hidden":!0}):(0,n.jsx)(R.Z,{className:"h-4 w-4","aria-hidden":!0})]})]}),d?(0,n.jsxs)("div",{className:"space-y-2 px-3 pb-3 pt-1",children:[(0,n.jsx)("p",{className:"text-sm text-slate-700 whitespace-pre-wrap",children:t}),(0,n.jsx)("div",{className:"flex justify-end",children:(0,n.jsxs)(g,{type:"button",size:"sm",variant:"secondary",onClick:c,children:[l?(0,n.jsx)(A.Z,{className:"h-4 w-4","aria-hidden":!0}):(0,n.jsx)(S.Z,{className:"h-4 w-4","aria-hidden":!0}),"Copy"]})})]}):null]})}function O(e){let{result:s,onExport:t}=e;return(0,n.jsxs)("section",{className:"space-y-6",children:[(0,n.jsx)(I,{result:s,onExport:t}),(0,n.jsx)(k,{models:s.models,pillars:s.pillars}),(0,n.jsx)(T,{pillars:s.pillars})]})}var z=t(6865),L=t(7168);function q(e){let{message:s,onRetry:t}=e;return(0,n.jsx)("div",{className:"rounded-lg border border-danger/40 bg-danger/10 p-4 text-danger",children:(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)(z.Z,{className:"mt-0.5 h-5 w-5","aria-hidden":!0}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-base font-semibold",children:"Analysis failed"}),(0,n.jsx)("p",{className:"text-sm text-danger/80",children:s})]}),(0,n.jsxs)(g,{type:"button",variant:"danger",onClick:t,children:[(0,n.jsx)(L.Z,{className:"h-4 w-4","aria-hidden":!0}),"Retry"]})]})]})})}let U=["mask","pillars","questions","models","evaluate"];var X=t(7119);let B=X.Ry({model:X.Z_(),answer:X.Z_(),inferred:X.O7().optional(),ai_provider_inferred:X.O7().optional()}),M=X.Ry({prompt:X.Z_(),category:X.Z_(),kind:X.Z_(),ai_provider_inferred:X.O7().optional().default(!1),id:X.Z_().optional(),assumptions:X.IX(X.Z_()).optional().default([]),responses:X.IX(B).optional().default([])}),D=X.Ry({title:X.Z_().optional(),pillar:X.Z_().optional(),summary:X.Z_().optional().default(""),ai_provider_inferred:X.O7().optional().default(!1),questions:X.IX(M).optional().default([])}),G=X.Ry({total_questions:X.oQ.number(),ai_provider_recognized_in:X.oQ.number()}).or(X.Ry({totalQuestions:X.oQ.number(),aiProviderRecognizedIn:X.oQ.number()}).transform(e=>{let{totalQuestions:s,aiProviderRecognizedIn:t}=e;return{total_questions:s,ai_provider_recognized_in:t}})),Q=X.Ry({client_name:X.Z_().nullable(),provider_name:X.Z_(),models_run:X.IX(X.Z_()),mode:X.G0([X.i0("stub"),X.i0("live")])}).or(X.Ry({clientName:X.Z_().nullable(),providerName:X.Z_(),modelsRun:X.IX(X.Z_()),mode:X.G0([X.i0("stub"),X.i0("live")])}).transform(e=>{let{clientName:s,providerName:t,modelsRun:a,mode:l}=e;return{client_name:s,provider_name:t,models_run:a,mode:l}})),V=X.Ry({story_id:X.Z_(),summary:G,selling_points:X.IX(D).optional().default([]),sellingPoints:X.IX(D).optional().default([]),pillars:X.IX(D).optional().default([]),metadata:Q}).or(X.Ry({data:X.Ry({story_id:X.Z_(),summary:G,selling_points:X.IX(D).optional().default([]),sellingPoints:X.IX(D).optional().default([]),pillars:X.IX(D).optional().default([]),metadata:Q})})).transform(e=>"data"in e?e.data:e);async function F(e,s){let t="https://story-ai-visibility-production.up.railway.app";if(!t)throw Error("NEXT_PUBLIC_API_URL is not configured");let a=await fetch("".concat(t,"/analyze"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),signal:s});if(!a.ok)throw Error(await H(a));return function(e){let s=function(e){var s,t,a;let l=null!==(t=null!==(s=e.selling_points)&&void 0!==s?s:e.sellingPoints)&&void 0!==t?t:[];return l.length>0?l:null!==(a=e.pillars)&&void 0!==a?a:[]}(e);return{storyId:e.story_id,summary:{totalQuestions:e.summary.total_questions,aiProviderRecognizedIn:e.summary.ai_provider_recognized_in},models:e.metadata.models_run,metadata:{clientName:e.metadata.client_name,providerName:e.metadata.provider_name,mode:e.metadata.mode},pillars:s.map(e=>{var s,t,a,l;return{title:null!==(s=e.pillar)&&void 0!==s?s:"Untitled pillar",summary:null!==(t=e.summary)&&void 0!==t?t:"",aiProviderInferred:null!==(a=e.ai_provider_inferred)&&void 0!==a&&a,questions:(null!==(l=e.questions)&&void 0!==l?l:[]).map(e=>{var s,t;return{prompt:e.prompt,category:e.category,kind:e.kind,aiProviderInferred:null!==(s=e.ai_provider_inferred)&&void 0!==s&&s,assumptions:e.assumptions,id:e.id,responses:(null!==(t=e.responses)&&void 0!==t?t:[]).map(e=>{var s,t;let a=null!==(t=null!==(s=e.ai_provider_inferred)&&void 0!==s?s:e.inferred)&&void 0!==t&&t;return{model:e.model,answer:e.answer,inferred:a}})}})}})}}(function(e){let s=V.safeParse(e);if(!s.success)throw Error("Received unexpected response format from API");let t=s.data,a=s.data.sellingPoints;return(!t.selling_points||0===t.selling_points.length)&&(null==a?void 0:a.length)&&(t.selling_points=a),t}(await a.json()))}async function H(e){if(504===e.status)return"Request timed out while waiting for analysis to complete. Please try again.";let s=e.statusText;try{let t=await e.json();"string"==typeof(null==t?void 0:t.message)&&(s=t.message)}catch(e){}return"Analysis failed (".concat(e.status,"): ").concat(s)}var J=t(257);let K=null!==(a=J.env.NEXT_PUBLIC_DEFAULT_PROVIDER_NAME)&&void 0!==a?a:"OpenAI",W=(null!==(l=J.env.NEXT_PUBLIC_DEFAULT_PROVIDER_ALIASES)&&void 0!==l?l:"OpenAI, Open AI, OpenAI Inc., ChatGPT, GPT-4o, GPT-5, Sora, DALL-E").split(",").map(e=>e.trim()).filter(Boolean),Y=(null!==(r=J.env.NEXT_PUBLIC_SHOW_SAMPLE_BUTTON)&&void 0!==r?r:"false")==="true";function $(){let[e,s]=(0,i.useState)(""),[t,a]=(0,i.useState)(K),[l,r]=(0,i.useState)(W),[d,o]=(0,i.useState)("idle"),[u,x]=(0,i.useState)(null),[p,h]=(0,i.useState)(null),{percentage:f,currentStep:v,steps:g,complete:b}=function(e){let[s,t]=(0,i.useState)(0),[a,l]=(0,i.useState)("mask"),r=(0,i.useRef)(null);return(0,i.useEffect)(()=>{if(!e){r.current&&clearInterval(r.current),r.current=null,t(0),l("mask");return}return r.current=setInterval(()=>{t(e=>{let s=Math.min(e+20,95),t=Math.min(Math.floor(s/(100/U.length)),U.length-1);return l(U[t]),s})},1e3),()=>{r.current&&clearInterval(r.current)}},[e]),{percentage:s,currentStep:a,complete:()=>{r.current&&clearInterval(r.current),r.current=null,t(100),l("evaluate")},steps:U}}("loading"===d),j=(0,i.useCallback)(async()=>{if(!e.trim()){x("Transcript cannot be empty"),o("error");return}o("loading"),x(null);try{let s=await F({text:e,provider_name:t,provider_aliases:l});b(),h(s),o("success")}catch(e){o("error"),h(null),x(e instanceof Error?e.message:"Unexpected error while analyzing transcript")}},[e,t,l,b]),N=(0,i.useCallback)(()=>{if(!p)return;let e=new Blob([JSON.stringify(p,null,2)],{type:"application/json"}),s=URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="analysis-".concat(p.storyId,".json"),document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(s)},[p]);return(0,n.jsxs)("div",{className:"flex min-h-screen flex-col bg-slate-50",children:[(0,n.jsx)(c,{}),(0,n.jsxs)("main",{className:"mx-auto w-full max-w-6xl flex-1 space-y-8 px-6 py-8",children:[(0,n.jsx)(y,{text:e,providerName:t,providerAliases:l,isLoading:"loading"===d,onTextChange:s,onProviderNameChange:a,onProviderAliasesChange:r,onAnalyze:j,onLoadSample:Y?()=>s("OpenAI has released new features in ChatGPT. The GPT-4o model is now integrated\nwith the latest Sora updates, providing enhanced multimodal capabilities. Customers of OpenAI Inc.\nare reporting improved results when using ChatGPT across creative workflows."):void 0,showLoadSampleButton:Y}),"idle"!==d?(0,n.jsx)(w,{percentage:f,currentStep:v,steps:g,isActive:"loading"===d}):null,"error"===d&&u?(0,n.jsx)(q,{message:u,onRetry:()=>{o("idle"),x(null)}}):null,"success"===d&&p?(0,n.jsx)(O,{result:p,onExport:N}):null,"idle"!==d||e?null:(0,n.jsx)(ee,{})]}),(0,n.jsx)(m,{})]})}function ee(){return(0,n.jsxs)("div",{className:"rounded-lg border border-dashed border-slate-300 bg-white/50 p-8 text-center text-sm text-slate-500",children:[(0,n.jsx)(d.Z,{className:"mx-auto h-10 w-10 text-slate-400","aria-hidden":!0}),(0,n.jsx)("p",{className:"mt-3",children:"Paste a transcript and configure provider masking to begin analyzing brand visibility."})]})}}},function(e){e.O(0,[251,971,117,744],function(){return e(e.s=3890)}),_N_E=e.O()}]);